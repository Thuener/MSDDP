using Base.Test
using LHS

srand(12345)

μ = [0.013321755695127785,  0.021611192484154013, 0.029607951338185168,  0.852064915519564];
Σ = [0.002816976519385445 0.003456320781447259 0.00373823362618616 -0.0022133205320017447;
 0.003456320781447259 0.004900706411403909 0.005680778380153239 -0.003916191304294986;
 0.00373823362618616 0.005680778380153239 0.007218934177646543 -0.007275181826092069;
 -0.0022133205320017447 -0.003916191304294986 -0.007275181826092069 0.5388580068276936];
n = 10;
x = lhsnorm(μ,Σ,n,rando=false)

@test_approx_eq_eps x [0.06833066185191783 0.13675924566707698 0.16936180677651375 1.1349169113355422;
 0.04912043195195379 0.04858556931098415 0.06234643935766734 0.9443090755203616;
 0.10062268571516687 0.09416675919143343 0.11766780038093853 2.0595017681373586;
 -0.02247692056169822 -0.025606493244429204 0.018931221558211985 -0.35537193709823167;
 0.01999125641438075 0.06882887821273723 0.08691550837488105 0.5692129197035858;
 -0.041687150461662256 -0.09353686069876904 -0.1101459041001435 1.3471872581739155;
 -0.0071292039051384214 -0.005363184342676127 0.04028468111815836 0.7598207555187665;
 -0.07397917432491138 -0.05094437422312541 -0.0584518977045682 0.35694257286521236;
 0.03377271529539399 0.030408120802647307 -0.027699605698510717 0.09125079245516854;
 0.006652254975874827 0.012814264165660729 -0.003130536681297001 1.6128790385839595] 1e-6
n = 5;
x = lhsnorm(μ,Σ,n,rando=true)

@test_approx_eq_eps x [-0.0020762604475388843 -0.11051077933610841 -0.23691431989139428 0.6152709056864617;
 0.05519220332130815 0.052468241406461155 0.1389139848547219 1.3495932048195252;
 0.008924298436569594 0.028483295476856844 -0.023313455707009614 0.7233234269189541;
 0.08165779775809852 0.1465928882246773 0.08713748945331501 -0.12650314057680967;
 -0.0963567377655244 -0.009664248506569075 0.030128533996765388 1.7884713466715008] 1e-6


srand(12345)
μ = [0.003480940734027744, 0.0036474124729790713, 0.0003774416657638946, 0.19755960933003242];
Σ = [0.0026436083446949674 0.003195825293348068 0.003440343100448316 -0.0015754933807833292;
 0.003195825293348068 0.0045452067210825274 0.005242225811220528 -0.0018253345555518745;
 0.003440343100448316 0.005242225811220528 0.006587382239429113 -0.0031685808603868493;
 -0.0015754933807833292 -0.0018253345555518745 -0.0031685808603868493 0.33360184080396793];
n = 10;
x = lhsnorm(μ,Σ,n,rando=false)

@test_approx_eq_eps x [0.05677023303465605 0.11454039823734244 0.13387818659818668 0.5871332585947925
 0.03816052730112198 0.029625004822789357 0.03165108721102585 0.27013943645360905
 0.08805278742180839 0.07352183243572057 0.08449716350794272 1.1475987015053781
 -0.031198645833066495 -0.04182543753698101 -0.030896203879498062 -0.7524794828453139
 0.009941948562732795 0.049120262482939145 0.05512084413334241 -0.024994847859504815
 -0.049808351566600566 -0.10724557329138436 -0.13312330326665897 0.4201140665195696
 -0.016330708689806593 -0.022330179876831214 0.010576454598881803 0.12497978220645584
 -0.08109090595375296 -0.06622700748976242 -0.08374228017641493 -0.19201403993472765
 0.02329259015786208 0.012119267791653935 -0.05436596080181462 -0.40106644487992466
 -0.0029800670946773 -0.004824442845695781 -0.009821571267354003 0.7961856635399895] 1e-6

x = lhsnorm(μ,Σ,n,rando=true)

@test_approx_eq_eps x [-0.05347740653107204 -0.10402459929529398 -0.19034775044250918 -0.06412004677053423
 0.00526870826483228 0.03125638744854374 0.04880462868036806 0.1985284219392433
 -0.0029540077729254717 -0.0347902372518591 -0.08364888204574061 0.10393740404462384
 0.08015764005733605 0.05158333022604602 0.028689754037339026 -0.366428626266702
 -0.06822573887133931 -0.06896692537651564 -0.05045793086406554 0.8616024431498224
 -0.013048401613650874 -0.025136408584631807 -0.008909616703390518 0.5385697940472858
 0.039137619932482284 0.06544018525809749 0.11979357965188242 0.4062145241685733
 0.020068417038460715 0.0127853552111243 -0.032763097613145796 0.9846618904430078
 -0.03712360743631246 -0.0007259622795874839 0.0167207233321304 -0.5576525005962252
 0.05355478386884081 0.13246147734043737 0.07778715897397363 -0.13750073652976802] 1e-6
