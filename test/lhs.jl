using Base.Test
using LHS

srand(12345)

μ = [0.013321755695127785,  0.021611192484154013, 0.029607951338185168,  0.852064915519564];
Σ = [0.002816976519385445 0.003456320781447259 0.00373823362618616 -0.0022133205320017447;
 0.003456320781447259 0.004900706411403909 0.005680778380153239 -0.003916191304294986;
 0.00373823362618616 0.005680778380153239 0.007218934177646543 -0.007275181826092069;
 -0.0022133205320017447 -0.003916191304294986 -0.007275181826092069 0.5388580068276936];
n = 10;
x = lhsnorm(μ,Σ,n,rando=false)

@test_approx_eq_eps x [0.06833066185191783 0.13675924566707698 0.16936180677651375 1.1349169113355422;
 0.04912043195195379 0.04858556931098415 0.06234643935766734 0.9443090755203616;
 0.10062268571516687 0.09416675919143343 0.11766780038093853 2.0595017681373586;
 -0.02247692056169822 -0.025606493244429204 0.018931221558211985 -0.35537193709823167;
 0.01999125641438075 0.06882887821273723 0.08691550837488105 0.5692129197035858;
 -0.041687150461662256 -0.09353686069876904 -0.1101459041001435 1.3471872581739155;
 -0.0071292039051384214 -0.005363184342676127 0.04028468111815836 0.7598207555187665;
 -0.07397917432491138 -0.05094437422312541 -0.0584518977045682 0.35694257286521236;
 0.03377271529539399 0.030408120802647307 -0.027699605698510717 0.09125079245516854;
 0.006652254975874827 0.012814264165660729 -0.003130536681297001 1.6128790385839595] 1e-6

x = lhsnorm(μ,Σ,n,rando=true)

@test_approx_eq_eps x [-0.04547460365368628 -0.0901922949226186 -0.1700507167826513 0.5194873795439611;
 0.015167213423809677 0.05027954961151665 0.08030344443636792 0.853296212270694;
 0.0066791552164835585 -0.01830134575471248 -0.058354124850498526 0.7330772845725978;
 0.09247276662792905 0.09770151520337246 0.05924639876636091 0.3897587143163769;
 -0.060698855931199606 -0.05378942531780058 -0.023608525523300394 1.6960194389433063;
 -0.0037409787264023 -0.008277090666525058 0.01988589163412048 1.2854663066168666;
 0.050129054783005285 0.06247822219957652 0.15461748363377875 1.1172515122931865;
 0.03044450002171689 0.03109976661841267 -0.005084874817035463 1.852419857566443;
 -0.02859307716173059 0.017070007258359336 0.04671674443552283 -0.1077597280961573;
 0.06501145204863482 0.15536797331053176 0.11064350247079932 0.18269548793933243] 1e-6



μ = [0.003480940734027744, 0.0036474124729790713, 0.0003774416657638946, 0.19755960933003242];
Σ = [0.0026436083446949674 0.003195825293348068 0.003440343100448316 -0.0015754933807833292;
 0.003195825293348068 0.0045452067210825274 0.005242225811220528 -0.0018253345555518745;
 0.003440343100448316 0.005242225811220528 0.006587382239429113 -0.0031685808603868493;
 -0.0015754933807833292 -0.0018253345555518745 -0.0031685808603868493 0.33360184080396793];

x = lhsnorm(μ,Σ,n,rando=false)

@test_approx_eq_eps x [0.03816052730112198 0.07352183243572057 0.08449716350794272 -0.40106644487992466;
 0.009941948562732795 -0.004824442845695781 -0.05436596080181462 1.1475987015053781;
 -0.08109090595375296 -0.10724557329138436 -0.13312330326665897 0.7961856635399895;
 0.08805278742180839 0.11454039823734244 0.13387818659818668 0.12497978220645584;
 0.02329259015786208 0.049120262482939145 0.05512084413334241 0.27013943645360905;
 -0.049808351566600566 -0.06622700748976242 -0.030896203879498062 -0.19201403993472765;
 -0.031198645833066495 -0.022330179876831214 -0.009821571267354003 -0.7524794828453139;
 -0.016330708689806593 -0.04182543753698101 -0.08374228017641493 0.4201140665195696;
 -0.0029800670946773 0.012119267791653935 0.010576454598881803 -0.024994847859504815;
 0.05677023303465605 0.029625004822789357 0.03165108721102585 0.5871332585947925] 1e-6

x = lhsnorm(μ,Σ,n,rando=true)

@test_approx_eq_eps x [0.06741555557580914 0.09934781957508239 0.10600875721564121 -0.09949362068442175;
 -0.04469837100921224 -0.07355712298202693 -0.034352533537167086 0.34187682840784983;
 -0.032164177893013554 -0.040658877042363796 -0.10169246765276707 -0.2970063858868023;
 0.02640653719315294 0.02110977302187184 0.05551500614288491 0.42448482010838307;
 -0.00629054345569299 -0.015077880752245924 -0.04526574069737644 0.5600939923239772;
 -0.01892646687387815 -0.004115255693397933 -0.010064218365177003 0.8510219812744015;
 0.011140687175407154 0.00704347973342803 0.005879883828526428 -0.17385820745400338;
 -0.10685708000488896 -0.09453011986106466 -0.11785843765003465 1.3106669969080191;
 0.1217060028230291 0.0402626116277155 0.036550786251361066 -0.5664025711513112;
 0.03892564541643028 0.0880393455098448 0.09817710224775393 0.1324400254687833] 1e-6
